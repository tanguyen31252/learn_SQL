-- create database ex06
-- go

-- use ex06
-- go

-- create table customers
-- (
--     customer_id int primary key,
--     customer_name VARCHAR(100),
-- )

-- CREATE TABLE orders
-- (
--     order_id int primary key,
--     customer_id int,
--     order_date date,
--     order_amount FLOAT,
--     FOREIGN KEY (customer_id) REFERENCES customers(customer_id)
-- )


-- insert into customers (customer_id, customer_name) values (1, 'Ernesta Leitche');
-- insert into customers (customer_id, customer_name) values (2, 'Waiter Osbidston');
-- insert into customers (customer_id, customer_name) values (3, 'Nap Yelyashev');
-- insert into customers (customer_id, customer_name) values (4, 'Starlin Dudson');
-- insert into customers (customer_id, customer_name) values (5, 'Cleopatra Dickson');
-- insert into customers (customer_id, customer_name) values (6, 'Liliane Partington');
-- insert into customers (customer_id, customer_name) values (7, 'Kaiser Tibbotts');
-- insert into customers (customer_id, customer_name) values (8, 'Nedi Pittle');
-- insert into customers (customer_id, customer_name) values (9, 'Zia Linch');
-- insert into customers (customer_id, customer_name) values (10, 'Starla Brando');
-- insert into customers (customer_id, customer_name) values (11, 'Morton Dibden');
-- insert into customers (customer_id, customer_name) values (12, 'Adela Skrzynski');
-- insert into customers (customer_id, customer_name) values (13, 'Saidee Palser');
-- insert into customers (customer_id, customer_name) values (14, 'Alley Bayly');
-- insert into customers (customer_id, customer_name) values (15, 'Julee Buncom');
-- insert into customers (customer_id, customer_name) values (16, 'Lyell Borges');
-- insert into customers (customer_id, customer_name) values (17, 'Arel Dainty');
-- insert into customers (customer_id, customer_name) values (18, 'Crin Ceccoli');
-- insert into customers (customer_id, customer_name) values (19, 'Morganne Harcus');
-- insert into customers (customer_id, customer_name) values (20, 'Blaine McTavy');
-- insert into customers (customer_id, customer_name) values (21, 'Dana Bream');
-- insert into customers (customer_id, customer_name) values (22, 'Vail Pridham');
-- insert into customers (customer_id, customer_name) values (23, 'Rafaelia Mc Ilwrick');
-- insert into customers (customer_id, customer_name) values (24, 'Crista Sanson');
-- insert into customers (customer_id, customer_name) values (25, 'Asa Elletson');
-- insert into customers (customer_id, customer_name) values (26, 'Swen Weond');
-- insert into customers (customer_id, customer_name) values (27, 'Nara Sussex');
-- insert into customers (customer_id, customer_name) values (28, 'Olin Meatyard');
-- insert into customers (customer_id, customer_name) values (29, 'Lucais Coltart');
-- insert into customers (customer_id, customer_name) values (30, 'Roger Jannequin');
-- insert into customers (customer_id, customer_name) values (31, 'Chandra Maystone');
-- insert into customers (customer_id, customer_name) values (32, 'Emmalynne Madders');
-- insert into customers (customer_id, customer_name) values (33, 'Cecily Akitt');
-- insert into customers (customer_id, customer_name) values (34, 'Livia Trevillion');
-- insert into customers (customer_id, customer_name) values (35, 'Beryl Ranyard');
-- insert into customers (customer_id, customer_name) values (36, 'Deeann Duval');
-- insert into customers (customer_id, customer_name) values (37, 'Merrile Kenrick');
-- insert into customers (customer_id, customer_name) values (38, 'Leighton Yorston');
-- insert into customers (customer_id, customer_name) values (39, 'Gale Bessom');
-- insert into customers (customer_id, customer_name) values (40, 'Kathy Vasyutichev');
-- insert into customers (customer_id, customer_name) values (41, 'Constancy Golsworthy');
-- insert into customers (customer_id, customer_name) values (42, 'Ezmeralda Paal');
-- insert into customers (customer_id, customer_name) values (43, 'Gerrilee Hansom');
-- insert into customers (customer_id, customer_name) values (44, 'Ernst Sheard');
-- insert into customers (customer_id, customer_name) values (45, 'Nora Brave');
-- insert into customers (customer_id, customer_name) values (46, 'Samuel Lowndesbrough');
-- insert into customers (customer_id, customer_name) values (47, 'Jed Skrzynski');
-- insert into customers (customer_id, customer_name) values (48, 'Perry Hovenden');
-- insert into customers (customer_id, customer_name) values (49, 'Sayres Hatchette');
-- insert into customers (customer_id, customer_name) values (50, 'Bridgette Cabrales');
-- insert into customers (customer_id, customer_name) values (51, 'Ivar Grandisson');
-- insert into customers (customer_id, customer_name) values (52, 'Dorisa Anniwell');
-- insert into customers (customer_id, customer_name) values (53, 'Waly Rivelon');
-- insert into customers (customer_id, customer_name) values (54, 'Terri Tackle');
-- insert into customers (customer_id, customer_name) values (55, 'Lars Denisovich');
-- insert into customers (customer_id, customer_name) values (56, 'Lazare Fritschmann');
-- insert into customers (customer_id, customer_name) values (57, 'Rudolf Wooffitt');
-- insert into customers (customer_id, customer_name) values (58, 'Corissa Curm');
-- insert into customers (customer_id, customer_name) values (59, 'Valene Spires');
-- insert into customers (customer_id, customer_name) values (60, 'Darrick Leither');
-- insert into customers (customer_id, customer_name) values (61, 'Hasheem Waterdrinker');
-- insert into customers (customer_id, customer_name) values (62, 'Vitoria Swithenby');
-- insert into customers (customer_id, customer_name) values (63, 'Clarabelle Cropper');
-- insert into customers (customer_id, customer_name) values (64, 'Caren Cay');
-- insert into customers (customer_id, customer_name) values (65, 'Nanny Davisson');
-- insert into customers (customer_id, customer_name) values (66, 'Betsey Mullin');
-- insert into customers (customer_id, customer_name) values (67, 'Bernardina Benzing');
-- insert into customers (customer_id, customer_name) values (68, 'Una Duly');
-- insert into customers (customer_id, customer_name) values (69, 'Franklin Tejada');
-- insert into customers (customer_id, customer_name) values (70, 'Janis Sambells');
-- insert into customers (customer_id, customer_name) values (71, 'Grange Spinella');
-- insert into customers (customer_id, customer_name) values (72, 'Briney Lamswood');
-- insert into customers (customer_id, customer_name) values (73, 'Cedric Madgewick');
-- insert into customers (customer_id, customer_name) values (74, 'Tremain Donoghue');
-- insert into customers (customer_id, customer_name) values (75, 'Camila O'' Lone');
-- insert into customers (customer_id, customer_name) values (76, 'Penny Culley');
-- insert into customers (customer_id, customer_name) values (77, 'Thalia Meeson');
-- insert into customers (customer_id, customer_name) values (78, 'Luz Jedrzejewski');
-- insert into customers (customer_id, customer_name) values (79, 'Blinnie Binley');
-- insert into customers (customer_id, customer_name) values (80, 'Elvin Littlecote');
-- insert into customers (customer_id, customer_name) values (81, 'Ignaz Flitcroft');
-- insert into customers (customer_id, customer_name) values (82, 'Tammie Cancellor');
-- insert into customers (customer_id, customer_name) values (83, 'Teirtza Rizon');
-- insert into customers (customer_id, customer_name) values (84, 'Richmound Atter');
-- insert into customers (customer_id, customer_name) values (85, 'Chlo Kingzet');
-- insert into customers (customer_id, customer_name) values (86, 'Bernadina Quinnette');
-- insert into customers (customer_id, customer_name) values (87, 'Alyce Burroughes');
-- insert into customers (customer_id, customer_name) values (88, 'Sarene Crofthwaite');
-- insert into customers (customer_id, customer_name) values (89, 'Amory Buckles');
-- insert into customers (customer_id, customer_name) values (90, 'Del Colley');
-- insert into customers (customer_id, customer_name) values (91, 'Perri Roundtree');
-- insert into customers (customer_id, customer_name) values (92, 'Babb Lidgerton');
-- insert into customers (customer_id, customer_name) values (93, 'Rodge Erangy');
-- insert into customers (customer_id, customer_name) values (94, 'Belita Almack');
-- insert into customers (customer_id, customer_name) values (95, 'Angelika Attac');
-- insert into customers (customer_id, customer_name) values (96, 'Laryssa Heinrici');
-- insert into customers (customer_id, customer_name) values (97, 'Krisha Newhouse');
-- insert into customers (customer_id, customer_name) values (98, 'Perry Splevins');
-- insert into customers (customer_id, customer_name) values (99, 'Gan Piesold');
-- insert into customers (customer_id, customer_name) values (100, 'Hobart Wheway');
-- insert into customers (customer_id, customer_name) values (101, 'Martin Garrix');




--Write a SQL query to retrieve all customers and their associated orders, if any.


SELECT c.customer_id, customer_name, order_id, order_amount FROM customers c
JOIN orders o on c.customer_id = o.customer_id
ORDER BY c.customer_id

SELECT c.customer_id, c.customer_name, o.order_id, o.order_amount FROM customers as c
LEFT JOIN orders as o
ON c.customer_id = o.customer_id
WHERE o.customer_id is NOT NULL
ORDER BY c.customer_id

-- Write a SQL query to retrieve all orders and their associated customers, if any.

select * from orders
ORDER BY customer_id

SELECT o.order_id, o.order_date, o.order_amount, c.customer_id, c.customer_name
FROM orders as o
LEFT JOIN customers as c
ON o.customer_id = c.customer_id

-- Write a SQL query to retrieve all customers and their total order amount, if any.

SELECT c.customer_id, sum(order_amount) 'total' FROM customers c
JOIN orders o on c.customer_id = o.customer_id
GROUP BY c.customer_id
ORDER BY c.customer_id

-- Write a SQL query to retrieve all orders and their associated customers' names, sorted customer_id order customer name in ascending order.

SELECT c.customer_id, customer_name FROM customers c
JOIN orders o on c.customer_id = o.customer_id
ORDER BY o.customer_id DESC, customer_name DESC

-- Write a SQL query to retrieve all customers who have not placed any orders.

SELECT customer_id, customer_name  FROM customers
WHERE customer_id not in 
            (
                select customer_id from orders
                GROUP BY customer_id
            )


SELECT  c.customer_id, c.customer_name FROM customers c
LEFT JOIN orders o
ON o.customer_id = c.customer_id
WHERE o.order_id is NULL

